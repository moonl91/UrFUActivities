namespace Mazes
{

    public static class DiagonalMazeTask
    {

        public static void MoveOut(Robot robot, int width, int height)
        {
            var primaryDirection = GetPrimaryDirection(width, height);
            var secondaryDirection = GetSecondaryDirection(width, height);
            var stepsBetweenTurns = CalculateStepRatio(width, height);

            NavigateDiagonally(robot, primaryDirection, secondaryDirection, stepsBetweenTurns);

        }

        private static Direction GetPrimaryDirection(int width, int height)
        {
            return width > height ? Direction.Right : Direction.Down;
        }

        private static Direction GetSecondaryDirection(int width, int height)
        {
            return width > height ? Direction.Down : Direction.Right;
        }

        private static int CalculateStepRatio(int width, int height)
        {
            if (width > height)
                return (width - 2) / (height - 2);
            else
                return (height - 2) / (width - 2);
        }
         private static void NavigateDiagonally(Robot robot, Direction primary, Direction secondary, int steps)
        {
            while (!robot.Finished)
            {
                MoveMultipleSteps(robot, primary, steps);
                if (robot.Finished) break;
                robot.MoveTo(secondary);
            }
        }    
    }
}
